See https://sourceforge.net/p/aoc-mgx-utils/aoc-mgx-utils-svn/HEAD/tree/recanalyst/trunk/uRecAnalyst.pas#l3005